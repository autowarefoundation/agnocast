<launch>
    <arg name="use_param" default="false" />
    <arg name="use_sim_time" default="false" />

    <node pkg="test_ros2_application" exec="test_ros2_talker" name="test_ros2_talker_node" output="screen">
        <param name="use_sim_time" value="$(var use_sim_time)" />
    </node>

    <node pkg="test_ros2_application" exec="test_ros2_listener" name="test_ros2_listener_node" output="screen" unless="$(var use_param)">
        <param name="use_sim_time" value="$(var use_sim_time)" />
    </node>

    <node pkg="test_ros2_application" exec="test_ros2_listener" name="test_ros2_listener_node" output="screen" if="$(var use_param)">
        <param name="use_sim_time" value="$(var use_sim_time)" />
        <param name="topic_name" value="/custom_topic" />
        <param name="qos.queue_size" value="10" />
        <param name="qos_overrides./custom_topic.subscription.durability" value="transient_local" />
    </node>

    <node pkg="test_ros2_application" exec="test_ros2_take_listener" name="test_ros2_take_listener_node" output="screen">
        <param name="use_sim_time" value="$(var use_sim_time)" />
    </node>
</launch>
